{"version":3,"file":"rete-context-menu-plugin.esm.js","sources":["src/presets/classic/factory.ts","src/presets/classic/index.ts","src/presets/index.ts","src/index.ts"],"sourcesContent":["import { NodeEditor } from 'rete'\nimport { BaseAreaPlugin } from 'rete-area-plugin'\n\nimport { Item } from '../../types'\nimport { BSchemes, ItemDefinition } from './types'\n\nexport function createItem<S extends BSchemes>(\n  [label, factory]: ItemDefinition<S>,\n  key: string | number,\n  context: { editor: NodeEditor<S>, area: BaseAreaPlugin<S, any> }\n): Item {\n  const item = {\n    label,\n    key: String(key)\n  }\n\n  if (typeof factory === 'function') {\n    return <Item>{\n      ...item,\n      async handler() {\n        const node = await factory()\n\n        await context.editor.addNode(node)\n\n        context.area.translate(node.id, context.area.area.pointer)\n      }\n    }\n  }\n  return <Item>{\n    ...item,\n    handler() {/* do nothing */},\n    subitems: factory.map((data, i) => createItem(data, i, context))\n  }\n}\n","import { NodeEditor } from 'rete'\nimport { BaseAreaPlugin } from 'rete-area-plugin'\n\nimport { Item, Items } from '../../types'\nimport { createItem } from './factory'\nimport { BSchemes, ItemDefinition } from './types'\n\n/**\n * Classic context menu preset.\n * Configures nodes/actions items for root and Delete/Clone items for nodes\n * @param nodes List of items\n * @example Presets.classic.setup([\n  [\"Math\", [\n    [\"Number\", () => new NumberNode()],\n  ]]\n])\n */\nexport function setup<Schemes extends BSchemes>(nodes: ItemDefinition<Schemes>[]) {\n  return <Items<Schemes>>(function (context, plugin) {\n    const area = plugin.parentScope<BaseAreaPlugin<Schemes, any>>(BaseAreaPlugin)\n    const editor = area.parentScope<NodeEditor<Schemes>>(NodeEditor)\n\n    if (context === 'root') {\n      return {\n        searchBar: true,\n        list: nodes.map((item, i) => createItem(item, i, { editor, area }))\n      }\n    }\n\n    const deleteItem: Item = {\n      label: 'Delete',\n      key: 'delete',\n      async handler() {\n        if ('source' in context && 'target' in context) {\n          // connection\n          const connectionId = context.id\n\n          await editor.removeConnection(connectionId)\n        } else {\n          // node\n          const nodeId = context.id\n          const connections = editor.getConnections().filter(c => {\n            return c.source === nodeId || c.target === nodeId\n          })\n\n          for (const connection of connections) {\n            await editor.removeConnection(connection.id)\n          }\n          await editor.removeNode(nodeId)\n        }\n      }\n    }\n\n    const clone = context.clone\n    const cloneItem: undefined | Item = clone && {\n      label: 'Clone',\n      key: 'clone',\n      async handler() {\n        const node = clone()\n\n        await editor.addNode(node)\n\n        area.translate(node.id, area.area.pointer)\n      }\n    }\n\n    return {\n      searchBar: false,\n      list: [\n        deleteItem,\n        ...(cloneItem ? [cloneItem] : [])\n      ]\n    }\n  })\n}\n","/**\n * Presets that create items for root and node specific context menu.\n * @module\n*/\n\nexport * as classic from './classic'\n","import { BaseSchemes, Scope } from 'rete'\nimport { BaseArea, BaseAreaPlugin, RenderSignal } from 'rete-area-plugin'\n\nimport { Item, Items, Position } from './types'\n\nexport * as Presets from './presets'\n\n/**\n * Context menu plugin props\n * @priority 8\n */\nexport type Props<Schemes extends BaseSchemes> = {\n  /** delay before hiding context menu */\n  delay?: number\n  /** menu items, can be produced by preset */\n  items: Items<Schemes>\n}\nexport type RenderMeta = { filled?: boolean }\n\n/**\n * Signal types produced by ContextMenuPlugin instance\n * @priority 10\n */\nexport type ContextMenuExtra =\n  | RenderSignal<'contextmenu', {\n    items: Item[]\n    onHide(): void\n    searchBar?: boolean\n  }>\n\ntype Requires<Schemes extends BaseSchemes> =\n  | { type: 'contextmenu', data: { event: MouseEvent, context: 'root' | Schemes['Node'] | Schemes['Connection'] } }\n  | { type: 'unmount', data: { element: HTMLElement } }\n  | { type: 'pointerdown', data: { position: Position, event: PointerEvent } }\n\n/**\n * Plugin for context menu.\n * Responsible for initialing rendering of context menu with predefined items.\n * @priority 9\n * @emits render\n * @emits unmount\n * @listens unmount\n * @listens contextmenu\n * @listens pointerdown\n */\nexport class ContextMenuPlugin<Schemes extends BaseSchemes> extends Scope<never, [Requires<Schemes> | ContextMenuExtra]> {\n  /**\n   * @param props Properties\n   */\n  constructor(private props: Props<Schemes>) {\n    super('context-menu')\n  }\n\n  setParent(scope: Scope<Requires<Schemes>>): void {\n    super.setParent(scope)\n\n    const area = this.parentScope<BaseAreaPlugin<Schemes, BaseArea<Schemes>>>(BaseAreaPlugin)\n    const container: HTMLElement = (area as any).container\n\n    if (!container || !(container instanceof HTMLElement)) throw new Error('container expected')\n\n    const element = document.createElement('div')\n\n    element.style.display = 'none'\n    element.style.position = 'fixed'\n\n    // eslint-disable-next-line max-statements\n    this.addPipe(context => {\n      const parent = this.parentScope()\n\n      if (!context || typeof context !== 'object' || !('type' in context)) return context\n      if (context.type === 'unmount') {\n        if (context.data.element === element) {\n          element.style.display = 'none'\n        }\n      } else if (context.type === 'contextmenu') {\n        context.data.event.preventDefault()\n        context.data.event.stopPropagation()\n\n        const { searchBar, list } = this.props.items(context.data.context, this)\n\n        container.appendChild(element)\n        element.style.left = `${context.data.event.clientX}px`\n        element.style.top = `${context.data.event.clientY}px`\n        element.style.display = ''\n\n        parent.emit({\n          type: 'render',\n          data: {\n            type: 'contextmenu',\n            element,\n            searchBar,\n            onHide() {\n              parent.emit({ type: 'unmount', data: { element } })\n            },\n            items: list\n          }\n        })\n      } else if (context.type === 'pointerdown') {\n        if (!context.data.event.composedPath().includes(element)) {\n          parent.emit({ type: 'unmount', data: { element } })\n        }\n      }\n      return context\n    })\n  }\n}\n"],"names":["createItem","_ref","key","context","_ref2","_slicedToArray","label","factory","item","String","_objectSpread","handler","_asyncToGenerator","_regeneratorRuntime","mark","_callee","node","wrap","_callee$","_context","prev","next","sent","editor","addNode","area","translate","id","pointer","stop","subitems","map","data","i","setup","nodes","plugin","parentScope","BaseAreaPlugin","NodeEditor","searchBar","list","deleteItem","connectionId","nodeId","connections","_iterator","_step","connection","removeConnection","getConnections","filter","c","source","target","_createForOfIteratorHelper","s","n","done","value","t0","e","f","finish","removeNode","clone","cloneItem","_callee2","_callee2$","_context2","concat","_toConsumableArray","ContextMenuPlugin","_Scope","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","_createClass","setParent","scope","_this2","_get","_getPrototypeOf","prototype","container","HTMLElement","Error","element","document","createElement","style","display","position","addPipe","parent","_typeof","type","event","preventDefault","stopPropagation","_this2$props$items","items","appendChild","left","clientX","top","clientY","emit","onHide","composedPath","includes","Scope"],"mappings":"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"}